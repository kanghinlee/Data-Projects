---
title: "Deloitte Productivity Cleaning Script"
output: html_notebook
---
### Library
```{r}
library(tidyverse)
library(janitor)
library(readxl)
library(here)
```

### Functions
```{r}
multiplesheets <- function(fname) {
   
  # getting info about all excel sheets
  sheets <- readxl::excel_sheets(fname)
  tibble <- lapply(sheets, function(x) readxl::read_excel(fname, sheet = x))
  data_frame <- lapply(tibble, as.data.frame)
    
  # assigning names to data frames
  names(data_frame) <- sheets
    
  # print data frame
  print(data_frame)
}
  
# specifying the path name
```

# Meta Data for Productivity Estimates: UK
```{r}
# raw - Raw Files
# pro - Productivity
# Hist - Historical

raw_pro_hist <- multiplesheets("data/raw_data/UK Labour Productivity - Historical.xls")

raw_pro_regi <- multiplesheets("data/raw_data/UK Labour Productivity - Region by Industry.xls")

raw_pro_indu <- multiplesheets("data/raw_data/UK Labour Productivity - Industry division.xls")

raw_pro_area <- multiplesheets("data/raw_data/UK Labour productivity - Rural and urban areas.xls")

raw_pro_publ <- multiplesheets("data/raw_data/UK Public Service Productivity.xls")

raw_pro_educ <- multiplesheets("data/raw_data/UK Education Productivity.xls")

raw_pro_labo <- multiplesheets("data/raw_data/UK Labour Productivity - Time Series.xls")

# <- multiplesheets("data/raw_data/")

# tt <- read.delim2("data/deloitte_data_dictionary_2019.numbers", header = FALSE)
```

# Meta Data for Productivity Estimates: UK & World
```{r}
raw_world_euro <- multiplesheets("data/raw_data/International Labour Productivity - Europe.xls")

raw_world_g7 <- multiplesheets("data/raw_data/International Labour Productivity - G7.xls")

raw_world_multi <- multiplesheets("data/raw_data/Multifactor Productivity - OECD Countries.xls")
```

```{r}
raw_world_g7
```


```{r}
clean_world_multi <-as.data.frame(raw_world_multi$DP_LIVE_25012019175641197) %>% 
  clean_names() %>% 
  select(-flag_codes)
```
```{r}

```




```{r}
# Remove na rows
test <- na.omit(test_raw)
```



```{r}


test1 <- test$`Table 1`
``` 

